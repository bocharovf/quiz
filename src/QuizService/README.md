# QuizService
**QuizService** is a web service built with ASP.NET Core 2.0 Web Api.

## Project structure
* **QuizService** - main web service project.
* QuizService.**BusinessLogic** - business logic layer.
* QuizService.**Model** - service domain model and data contracts.
* QuizService.**DataAccess** - data access layer.
* QuizService.**Interfaces** - shared interfaces and abstractions used for dependency injection in QuizService.
* QuizService.**CodeGen** - code generation. Generates client model in Typescript from service model written in C#.
* QuizService.**Common** - common and shared functionality.

## Data access
Data access layer uses Entity Framework Core to store data in PostgreSQL database. Repository pattern is widely used to abstract object persistence from business logic. "Unit of work" pattern utilized then to coordinate changes from multiple repositories.

Repository interfaces could be found in **QuizService.Interfaces** project while implementations located in **QuizService.DataAccess**. This is to isolate Entity Framework concepts from business logic, simplify dependency injection and unit testing.

## Authorization
Authorization is cookie-based and implemented via ASP.NET Core Identity. Business layer uses custom user entity to be independent from ASP.NET Core Identity infrastructure.

## Access control
Access to some resources like quizzes and scores is per user. If such resources created under specific user they are belongs to that user and could be viewed only by the owner. In the same time resources created by guests are visible to everyone.

Access control service is implemented to enforce access control rules. Repository uses access control service to pre-filter entire entity collection and guarantee that application works with allowed subset of data.

*- Why don't you use EF Core global query filters?*

EF Core global query filters are great but have limitations and not flexible. Access rules could be quite complex and it will be hard to implement it. Filtering on repository level provides the same functionality but more flexible.

## Code generation
Life is too short to write code twice. This is the reason of **QuizService.CodeGen** project that automatically generates client Typescript model from service model. It is done with awesome [TypeLITE](http://type.litesolutions.net/) library which uses T4 templates and some magic to produce Typescript code. Client model generated by T4 template is copied to client project on build step.

## Links
See [get started](../../docs/get%20started.md) guide to build, test and deploy project.